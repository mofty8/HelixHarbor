<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>HelixHarbor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9f9f9;
    }

    .container {
      width: 80%;
      margin: 0 auto;
    }


    /* Rotating wheel container */
    #loading-wheel {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #4CAF50;
      border-radius: 50%;
      animation: spin 2s linear infinite;
      display: none;
      /* Hide the loading wheel initially */
    }

    /* Rotating wheel animation */
    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Style the header */
    .header {
      display: flex;

      align-items: center;
      padding: 20px;
      background-color: #3f9a42;
      color: #fff;
    }

    .header h1 {
      margin: 0;
    }

    /* Style the question mark button */
    .info-icon {
      background-color: #f6faf6;
      color: #3f9a42;
      border-radius: 50%;
      font-weight: bold;
      margin-left: 10px;
      padding: 5px;
      cursor: pointer;
      position: relative;
    }

    /* Style the tooltip text */
    .tooltip-text {
      display: none;
      background-color: #333;
      color: white;
      border-radius: 5px;
      padding: 10px;
      position: absolute;
      left: 30px;
      /* Position the tooltip away from the edge of the window */
      top: calc(50% - 20px);
      /* Center the tooltip vertically with respect to the info icon */
      white-space: nowrap;
      z-index: 10;
      margin-left: 10px;
    }

    /* Show the tooltip text on hover */
    .info-icon:hover .tooltip-text {
      display: block;
    }

    .main-submit-button {
      background-color: #3f9a42;
      color: #fff;
      border: none;
      cursor: pointer;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      transition-duration: 0.4s;
    }

    .main-clear-button {
      background-color: #d72626;
      color: #fff;
      border: none;
      cursor: pointer;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      transition-duration: 0.4s;
    }



    .help-message {
      visibility: hidden;
      opacity: 0;
      background-color: #f9f9f9;
      color: #333;
      text-align: left;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      width: 350px;
      transition: opacity 0.2s, visibility 0.2s;
      box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
    }


    #results {
      margin-top: 20px;
      padding: 20px;
      border-radius: 5px;
      background-color: #ffffff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .result-item {
      padding: 15px;
      margin-bottom: 15px;
      border: 1px solid #e0e0e0;
      border-radius: 5px;
      background-color: #fafafa;
      position: relative;
    }

    .result-item:last-child {
      margin-bottom: 0;
    }

    .result-header {
      font-weight: bold;
      margin-bottom: 10px;
      font-size: 1.2em;
      color: #333;
    }

    .result-content {
      margin-bottom: 10px;
      color: #555;
    }

    .result-footer {
      color: #777;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 40px;
      /* Increased padding */
      background-color: #2d6a4f;
      /* Adjusted color */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      /* Added shadow for depth */
      color: #fff;
    }

    .header h1 {
      margin: 0;
      font-size: 2em;
      /* Increased font size */
      font-weight: bold;
      letter-spacing: 1px;
    }

    .info-icon {
      background-color: #f6faf6;
      color: #3f9a42;
      border-radius: 50%;
      font-weight: bold;
      margin-left: 10px;
      padding: 5px;
      cursor: pointer;
      position: relative;
    }

    .info-icon:hover {
      background-color: #388e3c;
      /* Hover effect color */
    }

    .info-icon:hover .help-message {
      visibility: visible;
      opacity: 1;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 40px;
      background: linear-gradient(to right, #1e3c72, #2a5298);
      /* Dark gradient background */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      /* Subtle shadow for depth */
      color: #fff;
    }

    .header h1 {
      margin: 0;
      font-size: 2.5em;
      /* Larger font size */
      font-weight: bold;
      letter-spacing: 1.5px;
      font-family: 'Georgia', serif;
      /* More elegant font */
    }

    .info-icon {
      background-color: #3f9a42;
      color: #fff;
      border-radius: 50%;
      font-weight: bold;
      margin-left: 10px;
      padding: 8px 10px;
      cursor: pointer;
      position: relative;
      font-size: 1.2em;
      transition: background-color 0.3s ease;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      /* Subtle shadow for depth */
    }

    .info-icon:hover {
      background-color: #2d6a4f;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 40px;
      background: linear-gradient(135deg, #2a5d98, #4f83cc);
      /* Vibrant gradient background */
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      /* Subtle shadow for depth */
      position: relative;
      /* For adding pseudo elements */
      color: #fff;
      overflow: hidden;
      /* Hide overflow for pseudo elements */
    }

    .header:before {
      content: "";
      position: absolute;
      width: 100px;
      height: 100px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      top: -50px;
      left: -50px;
      transform: rotate(45deg);
      pointer-events: none;
      /* Do not interfere with interactions */
    }

    .header:after {
      content: "";
      position: absolute;
      width: 150px;
      height: 150px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      bottom: -75px;
      right: -75px;
      transform: rotate(135deg);
      pointer-events: none;
    }

    .header h1 {
      margin: 0;
      font-size: 2.5em;
      font-weight: bold;
      letter-spacing: 1.5px;
      font-family: 'Georgia', serif;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      /* Subtle text-shadow for depth */
    }

    .info-icon {
      background-color: transparent;
      border: 2px solid #fff;
      color: #fff;
      border-radius: 50%;
      font-weight: bold;
      margin-left: 10px;
      padding: 8px 10px;
      cursor: pointer;
      position: relative;
      font-size: 1.2em;
      transition: background-color 0.3s ease, transform 0.3s ease;
    }

    .info-icon:hover {
      background-color: #2a5d98;
      transform: scale(1.1);
      /* Slight growth effect on hover */
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 40px;
      background: linear-gradient(135deg, #2a5d98, #4f83cc);
      /* Vibrant gradient background */
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      /* Subtle shadow for depth */
      position: relative;
      /* For adding pseudo elements */
      color: #fff;
      overflow: hidden;
      /* Hide overflow for pseudo elements */
    }

    .header:before {
      content: "";
      position: absolute;
      width: 100px;
      height: 100px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      top: -50px;
      left: -50px;
      transform: rotate(45deg);
      pointer-events: none;
      /* Do not interfere with interactions */
    }

    .header:after {
      content: "";
      position: absolute;
      width: 150px;
      height: 150px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      bottom: -75px;
      right: -75px;
      transform: rotate(135deg);
      pointer-events: none;
    }

    .header h1 {
      margin: 0;
      font-size: 2.5em;
      font-weight: bold;
      letter-spacing: 1.5px;
      font-family: 'Georgia', serif;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      /* Subtle text-shadow for depth */
    }

    .info-icon {
      background-color: transparent;
      border: 2px solid #fff;
      color: #fff;
      border-radius: 50%;
      font-weight: bold;
      margin-left: 10px;
      padding: 8px 10px;
      cursor: pointer;
      position: relative;
      font-size: 1.2em;
      transition: background-color 0.3s ease, transform 0.3s ease;
    }

    .info-icon:hover {
      background-color: #2a5d98;
      transform: scale(1.1);
      /* Slight growth effect on hover */
    }

    .info-icon {
      position: relative;
    }

    .new-tooltip-text {
      display: none;
      display: none;
      background-color: #333;
      color: white;
      border-radius: 5px;
      padding: 10px;
      position: absolute;
      right: 100%;
      top: 50%;
      transform: translateY(-50%);
      white-space: nowrap;
      z-index: 10;
      margin-right: 10px;
    }

    .info-icon:hover .new-tooltip-text {
      display: none;
      display: block;
    }
  </style>

  <style>
    .scrollable-container {
      overflow: auto;
      width: 100%;
      /* Adjust as needed */
      height: 400px;
      /* Adjust as needed */
    }

    .myDataFrame {
      border-collapse: collapse;
      width: 100%;
    }

    .myDataFrame th,
    .myDataFrame td {
      border: 1px solid black;
      padding: 8px;
    }
  </style>

</head>

<body>
  <div class="header">
    <h1>HelixHarbor</h1>
    <span class="info-icon">?

      <div class_="new-tooltip-text">
      </div>
    </span>
  </div>
  <form enctype="multipart/form-data" id="sequence-form" method="post">
    <input checked="" id="sequence_radio" name="input_type" type="radio" value="sequence" />
    <label for="sequence">Sequence</label><br />
    <input id="uniprot" name="input_type" type="radio" value="uniprot" />
    <label for="uniprot">List Against Background (Uniprot IDs)</label><br />
    <input id="setcmp" name="input_type" type="radio" value="setcmp" />
    <label for="uniprot">Compare 2 lists (Uniprot IDs)</label><br />
    <input id="ps_aac" name="input_type" type="radio" value="ps_aac" />
    <label for="uniprot">TMH Position Specific AAC</label><br />

    <div id="originalTextboxContainer">
      <label for="sequence" id="sequenceLabel">Enter Sequence or Uniprot Entry:</label><br />
      <textarea cols="50" id="sequence" name="sequence" rows="8"></textarea><br />
    </div>

    <div id="list1" style="display: none;">
      <label for="list_1">Enter your first list:</label><br />
      <textarea cols="50" id="list_1" name="list_1" rows="8"></textarea><br />
    </div>

    <div id="list2" style="display: none;">
      <label for="list_2">Enter your second list:</label><br />
      <textarea cols="50" id="list_2" name="list_2" rows="8"></textarea><br />
    </div>



    <div id="uniprot-options-organism" style="display: none;">
      <label for="option">Select Organism:</label>
      <select id="option4" name="option4">
        <option value="option1">Homo sapiens</option>
        <option value="option2">S.Cerevisiae</option>
      </select>
    </div>

    <div id="uniprot-options" style="display: none;">
      <label for="option">Select Background Set:</label>
      <select id="option" name="option">
        <option value="option1">Uniprot</option>
        <option value="option2">TopDB</option>
        <option value="option3">TmAlpha</option>

      </select>
    </div>

    <div id="uniprot-options2" style="display: none;">
      <label for="option2">TMH Comparison Preference:</label>
      <select id="option2" name="option2">
        <option value="option1">First TMH</option>
        <option value="option2">All TMHs</option>
      </select>
    </div>

    <div id="uniprot-options3" style="display: none;">
      <label for="option3">Select Feature</label>
      <select id="option3" name="option3">
        <option value="option1">Volume</option>
        <option value="option2">Surface Area</option>
        <option value="option3">Bulkiness </option>
        <option value="option4">Hydrophobicity </option>
        <option value="option6">Amino Acid Composition Against Background</option>
        <option value="option7"> Custom Scale</option>
      </select>
    </div>

    <div id="orientation_option" style="display: none;">
      <label for="option2">Orierntation Preference:</label>
      <select id="orientation" name="orientation">
        <option value="inside">Inside</option>
        <option value="outside">Outside</option>
      </select>
    </div>

    <input onclick="pasteExampleSequence()" type="button" value="Paste Example Sequence" id="paste-sequence" /><br />
    <input disabled onclick="pasteExampleList()" type="button" value="Paste Example list" id="paste-list" /><br />


    fasta file<input name="file" type="file" value="fasta_file" /><br />

    <input class="main-submit-button" type="submit" value="Submit" /><br />

  </form>
  <input Class='main-clear-button' onclick="clear_page()" type="button" value="Clear" /> <br />


  <div id="customScaleOptions" style="display: none;">
    <button id="downloadCustomScaleBtn" data-url="{{ url_for('main.download_custom_sheet') }}"
      onclick="downloadCustomScale()">Download Custom Scale Sheet</button>
    <button id="uploadCustomScaleBtn" data-upload-url="{{ url_for('main.upload_custom_sheet') }}"
      onclick="triggerFileUpload()">Upload Custom Scale Sheet</button>
    <input type="file" id="fileInput" style="display: none;" />
  </div>

  <form action="{{ url_for('main.download_csv') }}" enctype="multipart/form-data" method="get">
    <input disabled name="download_csv" type="submit" value="Download CSV" />
  </form>

  <form action="{{ url_for('main.download_aac') }}" enctype="multipart/form-data" method="get">
    <input disabled name="download_aac" type="submit" value="Download AAC" />
  </form>

  <!-- Dropdown for selecting the organism -->
  <label for="organism-select">Background Dataset Download:</label>
  <select id="organism-select" name="organism">
    <option value="">--Please choose an option--</option>
    <option value="option1">Homo sapiens</option>
    <option value="option2">Escherichia coli</option>
  </select>

  <!-- Button to download the background set -->
  <button id="download-background-btn" disabled>Download Background Set</button>
  <div id="loading-wheel"></div>
  <div id="loading-message" style="display: none;">Your job is being processed...</div>

  {% if error_message %}
  <div id="error-message" style="color: red;">
    {{ error_message }}
  </div>
  {% endif %}

  <div id="results">
    {% if results %}
    <h2>Results:</h2>

    {% if results.Error %}
    <div id="error-message" style="color: red;">
      {{ results.Error }}
    </div>
    {% endif%}

    {% if results.sequence %}
    <div class="scrollable-container">{{ results.sequence|safe }}</div>
    {% endif %}


    {% if results.plot_hydrophobicity %}
      {% if results.non_transmembrane %}
        <h2>Non-Transmembrane Proteins:</h2>
        <p>{{ results.non_transmembrane | join(', ') }}</p>
      {% endif %}
    <h2>Plot:
      <span class="info-icon">?

      </span>
    </h2>
    <img src="data:image/png;base64,{{ results.plot_hydrophobicity }}" />
    {% endif %}
    {% if results.plot_GP %}
    <h2>Plot:</h2>
    <img src="data:image/png;base64,{{ results.plot_GP }}" />
    {% endif %}
    {% if results.plot_polarity %}
    <h2>Plot:</h2>
    <img src="data:image/png;base64,{{ results.plot_polarity }}" />
    {% endif %}
    {% endif %}

  </div>

  <div id="proteinIdSection" style="display:none;">
    <label for="textField1">Upper Range:</label>
    <input type="text" id="textField1" placeholder="Enter Upper Range" /><br/>
    
    <label for="textField2">Lower Range:</label>
    <input type="text" id="textField2" placeholder="Enter Lower Range" /><br/>
    
    <button id="showProteinIds">Show Protein IDs</button>
  </div>





  <script>

    document.getElementById("sequence-form").addEventListener("submit", function (event) {

      event.preventDefault();
      showLoadingWheel();
      // Create a FormData object to send the form data as a multipart request
      var formData = new FormData(event.target);
      var sequenceRadio = document.getElementById("sequence_radio");
      var uniprotRadio = document.getElementById("uniprot");
      var selected_feature = document.getElementById("option3");


      // Send the request via AJAX
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "{{ url_for('main.index') }}", true);

      var timeout = setTimeout(function() {
      xhr.abort();
      alert("Request timed out. Please try again.");
      hideLoadingWheel();
      }, 3000000); // Adjust the timeout duration as needed


      xhr.onreadystatechange = function () {

        if (xhr.readyState === 4){
          clearTimeout(timeout);
          if (xhr.readyState === 4 && xhr.status === 200) {
            // Display the results when the request is completed
            var parser = new DOMParser();
            var responseDoc = parser.parseFromString(xhr.responseText, "text/html");
            var resultsElement = responseDoc.getElementById("results");

            document.getElementById("results").innerHTML = resultsElement.innerHTML;
            hideLoadingWheel();
            document.getElementById("proteinIdSection").style.display = "block";
            window.scrollTo(0, document.body.scrollHeight);


          
            if (sequenceRadio.checked) {
              enableDownloadButton();
            }

            if (uniprotRadio.checked) {
              if (selected_feature.value === "option6") {
                enableAACbutton();
              }
            }

          }
        }  
      };
      xhr.send(formData);
    });

    document.getElementById("showProteinIds").addEventListener("click", function() {
    // Capture the values from the text fields
    var upperRange = document.getElementById("textField1").value;
    var lowerRange = document.getElementById("textField2").value;
    
    var selectedFeature = document.getElementById("option3").value;
    var selectedMethod = document.querySelector('input[name="input_type"]:checked').value;

    // Create a FormData object to send the values
    var formData = new FormData();
    formData.append("upper_range", upperRange);
    formData.append("lower_range", lowerRange);
    formData.append("selected_feature", selectedFeature);
    formData.append("selected_method", selectedMethod);

    // Determine the URL for the Fetch request based on the selected method
    var requestURL = "{{ url_for('main.lower_upper_range') }}";

    // Make the AJAX call to the Flask backend
    fetch(requestURL, {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        // Clear previous results
        var resultsContainer = document.getElementById("proteinIdsResult");
        if (!resultsContainer) {
            resultsContainer = document.createElement("div");
            resultsContainer.id = "proteinIdsResult";
            document.getElementById("proteinIdSection").appendChild(resultsContainer);
        }
        resultsContainer.innerHTML = '';

        // Handle response based on the selected method
        if (selectedMethod === "uniprot") {
            // For 'uniprot', expecting 'unique_ids' in the response
            var proteinIds = data.unique_ids;
            var para = document.createElement("p");
            para.textContent = proteinIds.join(", ");
            resultsContainer.appendChild(para);
        } else if (selectedMethod === "setcmp") {
            // For 'setcmp', expecting 'list1' and 'list2' in the response
            var list1Ids = data.unique_ids_1; // Assuming the response structure
            var list2Ids = data.unique_ids_2; // Assuming the response structure

            var list1Para = document.createElement("p");
            list1Para.textContent = "List 1 IDs: " + list1Ids.join(", ");
            resultsContainer.appendChild(list1Para);

            var list2Para = document.createElement("p");
            list2Para.textContent = "List 2 IDs: " + list2Ids.join(", ");
            resultsContainer.appendChild(list2Para);
        }

        window.scrollTo(0, document.body.scrollHeight);
    })
    .catch(error => console.error('Error fetching protein IDs:', error));
});



    function triggerFileUpload() {
      console.log('Triggering file upload');
      document.getElementById('fileInput').click();
    }

    document.getElementById('fileInput').addEventListener('change', function () {
      console.log('File selected, calling uploadCustomScale');
      uploadCustomScale(this.files[0]);
    });

    function uploadCustomScale(file) {
      console.log('Uploading file', file.name);
      var uploadUrl = document.getElementById('uploadCustomScaleBtn').dataset.uploadUrl;
      var formData = new FormData();
      formData.append("file", file);

      fetch(uploadUrl, {
        method: 'POST',
        body: formData
      })
        .then(response => response.text())
        .then(data => {
          console.log(data); // Handle success
        })
        .catch(error => {
          console.error(error); // Handle errors
        });
    }

    document.addEventListener('DOMContentLoaded', function () {
    function updateButtonStates() {
      var sequenceSelected = document.querySelector('input[name="input_type"][value="sequence"]').checked;
      var uniprotSelected = document.querySelector('input[name="input_type"][value="uniprot"]').checked;
      var setcmpSelected = document.querySelector('input[name="input_type"][value="setcmp"]').checked;
      var ps_aacSelected = document.querySelector('input[name="input_type"][value="ps_aac"]').checked;

      // Enable or disable buttons based on the selected radio button
      document.getElementById('paste-sequence').disabled = !(sequenceSelected);
      document.getElementById('paste-list').disabled = !(uniprotSelected || setcmpSelected || ps_aacSelected);
    }

    // Add event listeners for radio buttons to update button states on change
    document.querySelector('input[name="input_type"][value="sequence"]').addEventListener('change', updateButtonStates);
    document.querySelector('input[name="input_type"][value="uniprot"]').addEventListener('change', updateButtonStates);
    document.querySelector('input[name="input_type"][value="setcmp"]').addEventListener('change', updateButtonStates);
    document.querySelector('input[name="input_type"][value="ps_aac"]').addEventListener('change', updateButtonStates);

    // Initial call to set button states on page load
    updateButtonStates();
  });

    document.addEventListener('DOMContentLoaded', function () {
      var customScaleSelect = document.getElementById('option3');
      var customScaleOptionsDiv = document.getElementById('customScaleOptions');

      customScaleSelect.addEventListener('change', function () {
        if (this.value === 'option7') {
          customScaleOptionsDiv.style.display = 'block';
        } else {
          customScaleOptionsDiv.style.display = 'none';
        }
      });

      // Trigger the change event on page load in case the selected option is persisted
      customScaleSelect.dispatchEvent(new Event('change'));
    });

    document.getElementById("setcmp").addEventListener("change", function (event) {
      if (event.target.checked) {
        document.getElementById("list1").style.display = "block";
        document.getElementById("list2").style.display = "block"; 
        document.getElementById("originalTextboxContainer").style.display = "none";
      }
    });

    document.getElementById("uniprot").addEventListener("change", toggleSingleTextbox);
    document.getElementById("sequence_radio").addEventListener("change", toggleSingleTextbox);
    document.getElementById("ps_aac").addEventListener("change", toggleSingleTextbox);
    function toggleSingleTextbox() {
      document.getElementById("list1").style.display = "none";
      document.getElementById("list2").style.display = "none";
      document.getElementById("originalTextboxContainer").style.display = "block";
    }
    
    document.getElementById("setcmp").addEventListener("change", function (event) {
      if (event.target.checked) {
        document.getElementById("uniprot-options").style.display = "none";
        document.getElementById("uniprot-options2").style.display = "block";
        document.getElementById("uniprot-options3").style.display = "block";
        document.getElementById("uniprot-options-organism").style.display = "none";
        document.getElementById('orientation_option').style.display='none'
        toggleOriginalTextbox();
      }
    });


    document.getElementById("uniprot").addEventListener("change", function (event) {
      if (event.target.checked) {
        document.getElementById("uniprot-options").style.display = "block";
        document.getElementById("uniprot-options2").style.display = "block";
        document.getElementById("uniprot-options3").style.display = "block";
        document.getElementById("uniprot-options-organism").style.display = "block";
        document.getElementById('orientation_option').style.display='none'
        toggleOriginalTextbox();
      }
    });

    document.getElementById("sequence_radio").addEventListener("change", function (event) {
      if (event.target.checked) {
        document.getElementById("uniprot-options").style.display = "none";
        document.getElementById("uniprot-options2").style.display = "none";
        document.getElementById("uniprot-options3").style.display = "none";
        document.getElementById("uniprot-options-organism").style.display = "none";
        document.getElementById('orientation_option').style.display='none'
        toggleOriginalTextbox();
      }
    });

    document.getElementById("ps_aac").addEventListener("change", function (event) {
      if (event.target.checked) {
        document.getElementById("uniprot-options").style.display = "none";
        document.getElementById("uniprot-options2").style.display = "none";
        document.getElementById("uniprot-options3").style.display = "none";
        document.getElementById("uniprot-options-organism").style.display = "none";
        document.getElementById('orientation_option').style.display='block'
        toggleOriginalTextbox();
      }
    });

    document.getElementById("toggleTextboxes").addEventListener("change", function (event) {
      if (event.target.checked) {
        document.getElementById("uniprot-options").style.display = "block";
        document.getElementById("uniprot-options2").style.display = "block";
        document.getElementById("uniprot-options3").style.display = "block";
        document.getElementById("uniprot-options-organism").style.display = "block";
      }
    });










    function downloadCustomScale() {
      var downloadUrl = document.getElementById('downloadCustomScaleBtn').dataset.url;
      window.location.href = downloadUrl;
    }


    function hideLoadingWheel() {
      document.getElementById('loading-wheel').style.display = 'none';
      document.getElementById('loading-message').style.display = 'none';
    }

    function enableDownloadButton() {
      document.getElementsByName('download_csv')[0].removeAttribute('disabled');
    }

    function enableAACbutton() {
      document.getElementsByName('download_aac')[0].removeAttribute('disabled');

    }

    function clear_page() {
      window.location.reload();
    }

    function pasteExampleSequence() {
      console.log('Paste triggered');
      var exampleSequence = "MTAWILLPVSLSAFSITGIWTVYAMAVMNHHVCPVENWSYNESCPPDPAEQGGPKTCCTLDDVPLISKCGSYPPESCLFSLIGNMGAFMVALICLLRYGQLLEQSRHSWVNTTALITGCTNAAGLLVVGNFQVDHARSLHYVGAGVAFPAGLLFVCLHCALSYQGATAPLDLAVAYLRSVLAVIAFITLVLSGVFFVHESSQLQHGAALCEWVCVIDILIFYGTFSYEFGAVSSDTLVAALQPTPGRACKSSGSSSTSTHLNCAPESIAMI"; // Replace with your example sequence
      document.getElementById("sequence").value = exampleSequence;
    }

    function pasteExampleList() {
      var exampleList = "P26992, Q9H300, Q15256, P24390, Q8NH09, Q00325, Q9UHF4, Q99965, Q8TB68, Q9H841, Q5T8D3, O60894, Q19T08, O43916, Q8IUH4, P11362, Q8IZF0, Q96GR4, Q9NWH2";
      document.getElementById("sequence").value = exampleList;
    }

    async function fetchJobId() {
      try {
        const response = await fetch("{{ url_for('main.generate_job_id') }}");
        if (!response.ok) { // check if HTTP response status is 200-299
          throw new Error(`HTTP error! status: ${response.status}`);
        } else {
          const data = await response.text(); // or .text() if the response is not JSON
          return data;
        }
      } catch (error) {
        console.log(error); // or handle error differently
      }
    }


    async function showLoadingWheel() {
      console.log('showLoadingWheel triggered');
      var jobId = await fetchJobId();
      document.getElementById('loading-wheel').style.display = 'block';
      document.getElementById('loading-message').innerText = 'Your job ' + jobId + ' is being processed...';
      document.getElementById('loading-message').style.display = 'block';
    }




    document.querySelector('input[type="submit"][value="Submit"]').addEventListener('click', function () {
      document.querySelector('#results').innerHTML = '';
    });

    function checkOption() {
      var selectedOption = document.getElementById("options3").value;
      if (selectedOption === "option5") {
        document.getElementById("customScaleButtons").style.display = "block";
      } else {
        document.getElementById("customScaleButtons").style.display = "none";
      }
    }

    // Add event listener for select element changes
    document.getElementById("uniprot-options3").addEventListener("change", checkOption);


  </script>








</body>

</html>



<script>
  // Get references to the select element and the button
  var selectElement = document.getElementById('organism-select');
  var button = document.getElementById('download-background-btn');

  // Enable the button when an option is selected from the dropdown
  selectElement.addEventListener('change', function () {
    button.disabled = !this.value;
  });

  // Function to handle the click event of the button
  function handleDownloadBackground() {
    // Get the selected organism option
    var option = selectElement.value;

    // Redirect to the download endpoint with the selected option as a parameter
    window.location.href = `/HarborHelix/download_background?option=${option}`;
  }

  // Add a click event listener to the button
  button.addEventListener('click', handleDownloadBackground);
</script>